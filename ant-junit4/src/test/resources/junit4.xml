
<project name="junit4" default="normal">
    <path id="junit.classpath">
        <fileset dir="..">
            <include name="dependency/junit-*.jar" />
        </fileset>
    </path>

    <taskdef resource="junit4.antlib.xml">
        <classpath refid="junit.classpath" />
        <classpath>
            <fileset dir="..">
                <include name="ant-junit4-*-standalone.jar" />
            </fileset>
        </classpath>
    </taskdef>

    <target name="normal">
        <junit4>
            <classpath>
                <path location="." />
                <path refid="junit.classpath" />
            </classpath>

            <fileset dir="${basedir}">
                <include name="**/tests/TestSub*.class" />
            </fileset>
        </junit4>
    </target>

    <target name="dir">
    	<delete dir="empty" failonerror="false" />
    	<mkdir dir="empty" />

        <junit4 dir="empty">
            <classpath>
                <path location="." />
                <path refid="junit.classpath" />
            </classpath>

            <fileset dir="${basedir}">
                <include name="**/tests/*.class" />
            </fileset>
        </junit4>

    	<fail message="Expected marker file to appear.">
    		<condition>
    			  <not><available file="empty/touch.me" type="file" /></not>
		    </condition>
		</fail>
    </target>	
</project>